# CH6 관계데이터 연산


## 1. 관계 데이터 연산의 개념 

> Q. 관계 데이터 연산에 대해 설명하라

- 관계 데이터 연산은 원하는 데이터를 얻기 위해 릴레이션에서 필요한 처리 요구를 수행하는 것으로 데이터 언어의 역할을 한다. 
  - 관계 대수 : 원하는 결과를 얻기 위해 데이터 처리과정을 순서대로 기술(절차언어)
  - 관계 해석 : 원하는 결과를 얻기 위해 처리를 원하는 데이터가 무엇인지만 기술(비절차언어)

<br>


## 2. 관계 대수 

릴레이션을 연산하면 피연산자인 릴레이션을 통해 릴레이션이라는 결과를 갖게 된다. 이를 폐쇄특성이라고 한다. 

> Q. 일반집합연산자에는 제약조건이 있다. 설명하여라. 

1. 연산을 위해 피연산자가 2개 필요하다. 
2. 합, 교, 차집합은 피연산자인 2개의 릴레이션이 합병가능해야한다 
   1. 두릴레이션의 차수가 같다.(속성의 개수가 같다)
   2. 2개의 릴레이션에서 서로 대응되는 속성의 도메인이 같다. 단 도메인이 같으면 속성의 이름은 달라도 된다. 
      고객 릴레이션과 직원 릴레이션이 있을 때 고객의 나이 속성 도메인이 INT고 직원의 직위 속성 도메인이 CHAR(20)이면 도메인이 달라서 합병이 불가능하다. 

<br>

> Q. 관계 대수 연산자의 일반집합 연산자에 대해 설명하세요

- 합집합
  - 합집합은 교환적 특징이 있어 R U S와 S U R이 같다. 결합적 특징이 있다. 
  - 또한 카디널리티는 중복이 없기 때문에 R과 S의 튜플의 합과 같거나 적다
- 교집합
  - 공통으로 속하는 튜플로 결과 릴레이션을 구성한다. 
  - 교환적, 결합적 특징이 있다.
- 차집합
  - R-S일때 R과 S의 차집합을 구성한다. 
- 카티션 프로덕트 (행렬의 곱)

```md
### 테이블 1: Customers
| CustomerID | Name    |
|------------|---------|
| 1          | Alice   |
| 2          | Bob     |

### 테이블 2: Orders
| OrderID | Product     |
|---------|-------------|
| 101     | Laptop      |
| 102     | Smartphone  |

---

## 카티션 프로덕트 결과

두 테이블의 모든 행이 조합됩니다.

| CustomerID | Name    | OrderID | Product     |
|------------|---------|---------|-------------|
| 1          | Alice   | 101     | Laptop      |
| 1          | Alice   | 102     | Smartphone  |
| 2          | Bob     | 101     | Laptop      |
| 2          | Bob     | 102     | Smartphone  |
```
<br>

> Q. 관계 대수 연산자의 순수관계계 연산자에 대해 설명하세요

- 셀렉트 : 조건을 만족하는 튜플
  - sigma 기호를 사용한다.  σ_조건식_(릴레이션)
  - `릴레이션 where 조건식` 형태로도 쓴다.  
- 프로젝트 : 주어진 속성들의 값으로만 구성된 튜플
  -  π_속성리스트_(릴레이션)
  -  `릴레이션[속성리스트]`
  -  수직적 부분집합을 나타내므로 수직적 연산자라고도 한다. 
- 조인 : 공통 속성을 이용해 연결하여 만든 새로운 튜플
  - 릴레이션1 ⋈ 릴레이션2
- 디비전(R / S) : 릴레이이션 S의 모든 튜플과 관련이 있는 릴레이션R의 튜플을 말함
  - R ÷ S 에서 R이 S의 모든 속성을 포함하고 있어야 한다. 

<br>

```md
## 예제 테이블

### 테이블 1: Students (A)
| StudentID | Subject  |
|-----------|----------|
| 1         | Math     |
| 1         | Science  |
| 2         | Math     |
| 2         | Science  |
| 3         | Math     |

### 테이블 2: Subjects (B)
| Subject   |
|-----------|
| Math      |
| Science   |

---

## 디비전 연산: Students ÷ Subjects

- **Students 테이블에서 Subjects 테이블에 포함된 모든 과목을 수강한 학생**을 찾습니다.

### 결과: Students ÷ Subjects
| StudentID |
|-----------|
| 1         |
| 2         |
```

<br>

> Q. 이중자연조인을 확장한 세미조인과 외부조인에 대해 설명하라

- 세미조인 
  - R ⋉ S라고 하며 릴레이션 S의 조인 속성으로만 구성한 릴레이션을 릴레이션 R에 자연 조인 한 것이다. 
  - 교환적 특성이 없다. 
- 외부 조인 
  - R ⟕ S 는 왼쪽 외부조인이다. 두 릴레이션에 자연 조인 연산을 수행할 때 조인 속성 값이 상대 릴레이션에 존재하지 않아 연산에서 제외된 모든 튜플을 결과 릴레이션에 포함시킨다. 
  - 왼쪽 외부조인은 R을 기준으로, 오른쪽 외부조인은 S를 기준으로, full 외부조인은 양쪽에 다 맞춰서 R, S의 속성을 모두 가져오는 것이다.
  - 없는 값에 대해서는 Null로 입력한다. 



# CH7 데이터베이스 언어 SQL


## 1. SQL의 소개

> Q. SQL에 대해 설명하라

- 관계데이터베이스를 위한 표준 질의어로 사용되는 언어이다. 
- 비절차적 언어의 특징을 갖고 있다. 

<br>

> Q. SQL을 기능에 따라 분류해보세요

1. 데이터 정의어
   - 테이블을 생성하고 변경/삭제하는 기능을 제공
2. 데이터 조작어 
   - 테이블에 새 데이터를 삽입하거나 테이블에 저장된 데이터를 수정, 삭제, 검색하는 기능을 제공 
3. 데이터 제어어
   - 보안을 위해 데이터에 대한 접근 및 사용 권한을 사용자별로 부여하거나 취소하는 기능을 하는 언어다. 데이터베이스 관리자가 주로 사용한다. 
 


<br>

## 2. SQL을 이용한 데이터 정의

> Q. `CREATE TABLE`에 대해 설명하세요

- 테이블을 생성하는 명령어이다. 

```sql

CREATE TABLE 테이블_이름 (
    속성_이름1 데이터_타입 제약조건 [DEFAULT 기본값값],
    속성_이름2 데이터_타입 제약조건,
    속성_이름3 데이터_타입 제약조건
);
```
<br>

> Q. 테이블 속성을 정의할 때 필요한 것들을 말하세요 

- PRIMARY : 기본키로 지정할 때 
- UNIQUE : 대체키로 지정할 때 
- ON DELETE 
  - `ON DELETE NO ACTION` : 튜플을 삭제하지 못한다 (기본)
  - `ON DELETE CASCADE` : 관련 튜플을 함께 삭제한다
  - `ON DELETE SET NULL` : 관련 튜플의 외래키 값을 NULL로 한다
  - `ON DELETE SET DEFAULT` : 관련 튜플의 외래키 값을 미리 지정한 기본 값으로 변경한다. 
- FOREIGN KEY : 외래키로 지정할 때 

<br>


> Q. 데이터 무결성 제약 조건을 정의하는 방법 

- CHECK 키워드를 사용ㅇ해 특정 속성에 대한 제약조건을 지정할 수 있다.
- 예를들어 CHECK(재고량 >= 0)으로 하면 재고량은 음수가 될 수 없도록 조건을 만드는 것이다. 

<br>

> Q. `ALTER TABLE`에 대해 설명하세요

- 테이블에 새로운 속성을 추가, 삭제, 새로운 제약조건 추가, 기존 제약조건 삭제등을 수행한다. 

<br>

```sql

--  속성 추가
ALTER TABLE 테이블_이름
  ADD 속성_이름 데이터_타입 [NOT NULL] [DEFAULT 기본값];

-- 기존 속성 삭제
ALTER TABLE 테이블_이름 DROP COLUMN 속성_이름;

-- 새로운 제약조건 추가
ALTER TABLE 테이블_이름 ADD CONSTRAINT 제약조건_이름 제약조건_내용;

-- 기존 제약조건 삭제 
ALTER TABLE 테이블_이름 DROP CONSTRAINT 제약조건_이름;

```

<br>


> Q. `DROP TABLE`에 대해 설명하세요

- 테이블 삭제 할 때 사용 

```SQL
DROP TABLE 테이블_이름;
```


## 3. SQL을 이용한 데이터 조작

> Q. SELECT

```SQL
SELECT [ALL | DISTINCT] 속성_리스트 
FROM 테이블_리스트
[WHERE 조건]
[GROUP BY 속성_리스트 [HAVING 조건]]
[ORDER BY 속성_리스트 [ASC | DESC]];
```

- 튜플의 중복 제거를 위해서 DISTINCT를 사용한다. 
- LIKE
  - LIKE '데이터%' : 0개 이상의 문자를 대체 
  - LIKE '데이터_' : 1개의 문자만을 대체
- IS NULL 
  - 널값이 아닌지를 확인할 수 있다. 

<br>

> Q. INSERT

```SQL
INSERT
INTO 테이블이름[(속성_리스트)]
VALUES (속성값_리스트);
```
- 속성 리스트 순서대로 속성값을 나열해야한다. 


```SQL
INSERT 
INTO 테이블이름[(속성_리스트)]
SELECT 문;
```
- 부속질의문을 통해 SELECT문 결과를 붙일 수 있다.


<br>

> Q. UPDATE

```SQL

UPDATE 테이블_이름
SET 속성_이름1 = 값1, 속성_이름2=값2, ...
[WHERE 조건];
```

<br>

> Q. DELETE

```SQL
DELETE 
FROM 테이블_이름
[WHERE 조건];
```


<br>

## 4. 뷰

> Q. 뷰란 무엇인가

- 다른 테이블을 기반으로 만들어진 가상 테이블이다. 
- 데이터를 실제로 저장하고 있지 않고 논리적으로만 존재한다. 


> Q. 뷰 생성 SQL문 

```SQL

CREATE VIEW 뷰_이름[(속성_리스트)]
AS SELECT 문
[WITH CHECK OPTION ]
```


## 5. 삽입 SQL




> Q. 

- 




# 예상 면접 질문 

> Q.  세미조인과 외부조인의 차이점을 설명해주세요.


- 세미조인은 R 릴레이션의 튜플 중에서 S 릴레이션과 조인이 가능한 튜플만 반환합니다. 결과 릴레이션은 R의 속성만 포함하며, 조인 속성 외의 S 속성은 포함되지 않습니다.
예: R ⋉ S

- 외부조인은 조인되지 않은 튜플도 결과에 포함시키는 조인 방식입니다.
  - 왼쪽 외부조인: R의 모든 튜플을 유지하고, S에 일치하는 값이 없으면 NULL로 채웁니다.
  - 오른쪽 외부조인: S의 모든 튜플을 유지하고, R에 일치하는 값이 없으면 NULL로 채웁니다.
  - 완전 외부조인: R과 S 양쪽의 튜플을 모두 포함합니다.

> Q. 데이터베이스의 VIEW의 장점과 제한점을 설명하세요

장점:
- 질의문을 좀 더 쉽게 작성할 수 있다.
- 특정 데이터만 노출하여 보안성을 높인다.
- 데이터 독립성을 제공한다.

제한점:
- 데이터 삽입, 삭제, 수정이 제한된다.
- 뷰 자체는 데이터를 저장하지 않으므로 대규모 데이터 처리 시 성능 저하가 발생할 수 있음.


> Q. SQL의 CHECK에 대해서 설명하세요

CHECK는 속성 값에 대한 조건을 지정하여 무결성을 유지합니다.

```SQL
CREATE TABLE 상품 (
    상품ID INT PRIMARY KEY,
    재고량 INT CHECK(재고량 >= 0)
);
```

