# Chapter 02. 물리 계층과 데이터 링크 계층
## 02-1 이더넷
**이더넷(Ethernet)**
- 다양한 통신 매체의 규격들과  송수신되는 프레임의 형태, 프레임을 주고받는 방법 등이 정의된 네트워크 기술
- 특히 유선 LAN 환경에서 가장 대중적으로 사용되는 기술. 유선 LAN 환경 대부분 이더넷을 기반으로 구성됨
- 국제적으로 표준화가 이루어져 있음(IEEE 802.3)

### 통신 매체 표기 형태
```
형태: (전송속도)BASE-(추가특성)
```
1. 전송 속도: data rate. 숫자만 표기되어 있으면 Mbps, 숫자 뒤에 G가 붙어있으면 Gbps를 의미.  
만약 100Base-T라면 100Mbps 속도를 지원하는 케이블이라는 의미

2. BASE: 베이스밴드(Baseband)의 약자로, 변조타입을 의미.
   - 변조타입: 비트 신호로 변환된 데이터를 통신 매체로 전송하는 방법
   - BASE 외에 BOARD(브로드밴드), PASS(패스밴드)도 있음

3. 추가 특성: additional distinction. **통신 매체**의 특성을 명시
    - 전송 가능한 최대 거리, 물리 게층 인코딩 방식, 레인 수 등

### 통신 매체 종류
10BASE-T 와 같은 경우, T가 추가 특성이며, 여기서 T는 트위스티드 페어 케이블을 의미
T 외에도 C, S, L 등이 있음

| 추가 특성 표기(통신 매체의 종류) | 케이블 종류       |  
|---------------------|--------------|
| C                   | 동축 케이블       |
| T                   | 트위스티드 페어 케이블 |
| S                   | 단파장 광섬유 케이블  |
| L                   | 장파장 광섬유 케이블  |

ex) 1000BASE-SX 케이블: 1000Mbps 속도를 지원하는 단파장 광섬유 케이블

### 이더넷 프레임
- 이더넷 프레임: 이더넷 네트워크에서 주고받는 프레임
- 캡슐화 과정을 통해 만들어지며, 수신자는 이를 역캡슐화함
- 아래의 형태로 구성됨  

<table style="border: 2px;">
  <tr>
    <td colspan="4"> 헤더 </td>
    <td> 페이로드 </td>
    <td> 트레일러 </td>
  </tr><tr>
    <td> 프리앰블 </td>
    <td> 수신지 MAC 주소 </td>
    <td> 송신지 MAC 주소 </td>
    <td> 타입/길이 </td>
    <td> 데이터 </td>
    <td> FCS </td>
  </tr>
</table>

- 프리앰블
  - preamble. 이더넷 프레임의 시작을 알리는 8byte 크기의 정보
  - 첫 7byte는 10101010, 마지막 byte는 10101011 값을 가짐
  - 수신자는 프리앰블을 통해 이더넷 프레임이 오고 있음을 알아차림

- 수신지 MAC 주소 & 송신지 MAC 주소
  - MAC주소: 일반적으로 변경되지 않는 주소로, network interface마다 부여됨
  - 총 8byte(48bit)로 구성됨

- 타입/길이
  - 필드에 명시된 크기가 1500 이하면 프레임의 길이, 1536보다 크면 타입을 의미
  - 타입: 어떤 정보를 캡슐화했는지 나타내는 정보(= 이더타입)  

|타입|프로토콜|  
|---|---|
|0800|IPv4|
|86DD|IPv6|
|0806|ARP|


- 데이터
  - 상위 계층에서 전달받거나 상위 계층으로 전달해야 할 내용

- FCS
  - Frame Check Sequence
  - 수신한 이더넷 프레임에 오류가 있는지 확인하기 위한 필드
  - CRC(Cyclic Redundancy Check - 순환 중복 검사)라는 오류 검출용 값이 들어감
    - 송신자는 프리앰블을 제외한 필드 값으로 CRC 값을 계산해 FCS에 명시
    - 수신자는 똑같이 CRC를 계산한 후 FCS 필드 값과 비교
    - 일치하지 않으면 오류가 있다고 판단해 해당 프레임을 폐기

## 02-2 NIC와 케이블
### NIC
- 호스트와 통신 매체를 연결하고, MAC 주소가 부여되는 네트워크 장비
- 역할: bit 신호를 전기 신호로, 전기 신호를 bit 신호로 변환하는 역할(= 네트워크 인터페이스 역할)

### 트위스티드 페어 케이블
- 구리 선으로 전기 신호를 주고받는 통신 매체
- 케이블 본체, 커넥터로 이루어져 있음
  - 커넥터: 접합부(RJ-45가 주로 사용됨)
- 구리 선이 두 가닥씩 꼬여져 있는 형태
- 노이즈가 발생할 수 있기 때문에 그물 모양 철사 or 포일로 선을 감싸 보호(= 차폐)
  - 그물 모양 철사 = 브레이드 실드(braided shield)
  - 포일 = 포일 실드(foil shield)
- STP 케이블: 브레이드 실드로 감싼 트위스티드 페어 케이블
- FTP 케이블: 포일 실드로 감싼 트위스티드 페어 케이블
- UTP 케이블: 아무것도 감싸지 않은 구리 선만 있는 케이블

```
케이블 명칭 표기 예시: XX/YTP
- X, Y엔 U, S, F를 명시할 수 있음
- XX는 케이블 외부를 감싸는 실드의 종류, Y에는 꼬인 구리 선 쌍을 감싸는 실드의 종류가 명시됨

S/FTP 케이블: 외부는 브레이드 실드, 내부는 포일 실드로 감싼 케이블
U/UTP 케이블: 아무것도 감싸지 않은 케이블
SF/FTP 케이블: 외부는 브레이드 실드와 포일 실드, 내부는 포일 실드로 감싼 케이블
```

- 트위스티드 페어 케이블은 카테고리에 따라서도 분류 가능
  - 카테고리는 트위스티드 페어 케이블 성능의 등급을 구분하는 역할
  - ex) Cat5, Cat6a, Cat8 등

### 광섬유 케이블
- 빛(광신호)을 이용해 정보를 주고받는 케이블 ex) 해저 광섬유 케이블
- 트위스티드 페어 케이블과 같이 케이블 보체와 커넥터로 이루어져 있음
- 종류: LC 커넥터, SC 커넥터, FC 커넥터, ST 커넥터
- 광섬유 중심은 "코어"가 있으며, 이를 "클래딩"이 둘러싸는 형태
  - 클래딩은 빛이 코어 안에서만 흐르도록 가두는 역할
- 종류:
  - 싱글 모드 광섬유 케이블: 코어의 지름이 작아 빛이 이동할 수 있는 경로가 적음. 장거리 전송에 적합
  - 멀티 모드 광섬유 케이블: 코어의 지름이 커 빛이 여러 경로로 이동 가능. 신호 손실 가능성이 높아 장거리 전송에 부적합

## 02-3 허브
- 대표적인 물리 계층 네트워크 장비

### 주소 개념이 없는 물리 계층
송수신지를 특정할 수 있는 주소는 데이터 링크 계층부터이며, 물리계층은 단지 송수신이 이루어질 뿐임

### 허브
- 허브: hub. 여러 대의 호스트를 연결하는 장치(= 리피터 허브)
- 커넥터를 연결할 수 있는 포트(port)가 존재
- 특징: 
  1. 전달받은 신호를 다른 모든 포트로 다시 내보냄. 폐기 작업은 상위 계층에서 수행
  2. 반이중 모드로 통신
     - 반이중: 1차선 도로처럼 송수신을 번갈아가며 통신하는 방식
     - 전이중: 통신을 양방향으로 할 수 있는 방식
- 리피터: repeater. 전기 신호의 감소나 왜곡을 방지하기 위해 신호를 증폭시키는 장비
- 충돌: collision. 허브는 반이중 통신이기 때문에 동시에 송신이 불가. 이 경우 충돌이 발생
  - 호스트가 많이 연결되어 있을수록 충돌 발생 가능성이 높아짐
  - 콜리전 도메인: 충돌이 발생할 수 있는 영역

### CSMA/CD 프로토콜
- Carrier Sense Multiple Access With Collision Detection. 충돌 문제를 해결하기 위한 프로토콜
  - CS: 캐리어 감지. 현재 통신 매체의 사용 가능 여부를 검사
  - MA: 다중 접근. 복수의 호스트가 네크워크에 접근하려는 상황
  - CD: 충돌 검출. 충돌이 발생하면 이를 검출. 충돌이 감지되면 전송이 중단되고 충돌 발생을 알리는 잼 신호(jam signal)을 다른 호스트에 보냄
- 동작 과정
  - 각 호스트들은 메시지를 전송하기 전에 먼저 현재 전송이 가능한 상태인지 확인하고,
  - 다른 호스트가 전송 중이지 않을 때 메시지를 전송.
  - 부득이하게 충돌이 발생하면 임의의 시간만큼 기다린 후 다시 전송

## 02-4 스위치
데이터 링크 계층의 네트워크 장비

### 스위치
- switch. 2계층에서 사용하므로 L2 스위치라고도 함
- 여러 포트에 여러 호스트를 연결할 수 있음. L2 스위치는 특정 호스트에만 프레임을 전달할 수 있으며, 전이중 모드를 지원
- 따라서 CSMA/CD 프로토콜이 필요하지 않음
- 특징:
  - MAC 주소 학습(MAC address learning): 연결된 호스트의 MAC 주소 관계를 기억해 원하는 호스트에만 프레임 전달 가능
  - MAC 주소 테이블(MAC address table): 연결된 호스트의 MAC 주소를 기억

### MAC 주소 학습
- 스위치는 아래 세 기능으로 동작
  1. 플러딩
  2. 포워딩과 필터링
  3. 에이징
- 네트워크 통신이 발생하면 가장 먼저 송신지 MAC 주소를 table에 저장
- 이후 수신지의 MAC 주소를 알기 위해 플러딩(flooding) 수행.
  - 플러딩: 송신지 포트를 제외한 모든 포트로 프레임을 전송
  - 수신자는 관련이 없다면 폐기하고, 관련이 있다면 응답을 함. 이를 통해 수신지의 MAC 주소를 알 수 있음
- 수신지 MAC 주소를 알았으므로 프레임을 어디로 보내야 하는지 알 수 있음(= 필터링)
- 목적지에 프레임을 보냄(= 포워딩)
- 만약, 특정 포트에서 일정 시간 동안 프레임을 전송받지 못했다면 해당 항목은 삭제됨(= 에이징)

### VLAN
- Virtual LAN. 스위치의 또 다른 중요한 기능
- 스위치 한 대로 가상의 LAN을 만드는 방법
- 물리적으로 한 대의 스위치라 해도 논리적으로 LAN을 구획할 수 있음
- 별개의 LAN으로 간주하므로 브로드캐스트 도메인도 달라짐 

**포트 기반 VLAN**  
- 스위치의 포트가 VLAN을 결정하는 방식. 사전에 특정 포트에 VLAN을 할당하고 연결함으로써 VLAN에 포함  
- 이 방식은 포트 수가 부족해질 가능성이 있다는 문제점이 있음
  
**VLAN 트렁킹(VLAN Trunking)**
- 두 대 이상의 VLAN 스위치를 효율적으로 연결해 확장하는 방식
- 스위치 간 통신을 위한 특별한 포트인 트렁크 포트에 VLAN 스위치를 서로 연결하는 방식

**MAC 기반 VLAN**
- 사전에 설정된 MAC 주소에 따라 VLAN 결정